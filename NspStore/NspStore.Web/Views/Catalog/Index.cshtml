@using NspStore.Application.Services
@model NspStore.Application.ViewsModels.CatalogVm
@{
    ViewData["Title"] = "Каталог";
}

<section class="section catalog">
    <div class="container">
        <header class="catalog__header">
            <h1 class="h1 catalog__title">Каталог NSP</h1>

            <form class="catalog__filter form" method="get" aria-label="Фильтр каталога">
                <div class="form__row form__row--2">
                    <input class="form__input" type="text" name="q" value="@Model.Q" placeholder="Поиск по товарам..." />
                    <button class="btn btn--primary" type="submit">Найти</button>
                </div>
            </form>
        </header>

        <div class="catalog-grid">
            @foreach (var p in Model.Items)
            {
                var image = p.Images.OrderBy(i => i.SortOrder).FirstOrDefault()?.Url ?? "/images/placeholder.png";
                <article class="product-card" itemscope itemtype="https://schema.org/Product">
                    <figure class="product-card__media">
                        <img class="product-card__image" src="@image" alt="@p.Name" itemprop="image" />
                    </figure>

                    <div class="product-card__content">
                        <h2 class="product-card__title" itemprop="name">@p.Name</h2>

                        <div class="product-card__meta">
                            <span class="product-card__sku">Артикул: @p.Sku</span>
                            <span class="product-card__price" itemprop="offers" itemscope itemtype="https://schema.org/Offer">
                                <meta itemprop="priceCurrency" content="BYN" />
                                <span itemprop="price">@p.CurrentPrice.ToString("0.00")</span> BYN
                            </span>
                        </div>

                        <div class="product-card__actions">
                            <a class="btn btn--primary product-card__btn"
                               asp-controller="Catalog"
                               asp-action="Product"
                               asp-route-slug="@p.Slug"
                               aria-label="Подробнее о @p.Name">
                                Подробнее
                            </a>
                        </div>
                    </div>
                </article>
            }
        </div>
    </div>
</section>
